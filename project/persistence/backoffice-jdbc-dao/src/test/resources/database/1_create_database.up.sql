CREATE TABLE Department (Id INT(11) AUTO_INCREMENT, Name VARCHAR(20) NOT NULL, PRIMARY KEY (Id), UNIQUE (Name));
CREATE TABLE User (Id INT(11) AUTO_INCREMENT, AccountName VARCHAR(60) NOT NULL, FirstName VARCHAR(60) NOT NULL, LastName VARCHAR(40) NOT NULL, DepartmentId INT(11) NOT NULL, BirthDate DATE NOT NULL, CreatedDate TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP(), PRIMARY KEY (Id), UNIQUE (AccountName), CONSTRAINT fk_user_department FOREIGN KEY (DepartmentId) REFERENCES Department (Id));
CREATE TABLE UserRole (Id INT(11) AUTO_INCREMENT, RoleName VARCHAR(20) NOT NULL, PRIMARY KEY (Id), UNIQUE (RoleName));
CREATE TABLE UserUserRole (UserId INT(11), UserRoleId INT(11), CreateDdate TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP(), PRIMARY KEY (UserId, UserRoleId), CONSTRAINT fk_useruserrole_user FOREIGN KEY (UserId) REFERENCES User (Id), CONSTRAINT fk_useruserrole_user_role FOREIGN KEY (UserRoleId) REFERENCES UserRole (Id));
CREATE TABLE UserStatus (Id INT AUTO_INCREMENT, UserId INT (11) NOT NULL, Active TINYINT (1) NOT NULL CHECK (Active >= 0 AND Active <= 1), PRIMARY KEY (Id), CONSTRAINT fk_user_status_user_id FOREIGN KEY (UserId) REFERENCES User(Id));
CREATE TABLE UserPassword (Id INT AUTO_INCREMENT, UserId INT (11) NOT NULL, Value VARCHAR(100) NOT NULL, EffDate TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP(), EndDate TIMESTAMP, PRIMARY KEY (Id), UNIQUE (UserId, EffDate), CONSTRAINT fk_user_password_user_id FOREIGN KEY (UserId) REFERENCES User (Id));
CREATE TABLE LoginAttempt (Id INT AUTO_INCREMENT, UserId INT(11) NOT NULL, Success TINYINT(1) NOT NULL CHECK (Success >= 0 AND Success <= 1), CreateDdate TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP(), PRIMARY KEY  (Id), UNIQUE (UserId, CreatedDate),  CONSTRAINT fk_loginattempt_user FOREIGN KEY (UserId) REFERENCES User (Id));
CREATE TABLE State (Id INT(11) NOT NULL AUTO_INCREMENT, Name VARCHAR(120) NOT NULL, Code CHAR(2) NOT NULL, PRIMARY KEY (Id), UNIQUE (Code), UNIQUE (Name));
CREATE TABLE Address (Id INT(11) auto_increment, Description VARCHAR(120) NOT NULL, City VARCHAR(100) NOT NULL, StateId INT(11) NOT NULL, Region VARCHAR(100) NOT NULL, PostalCode VARCHAR(16) NOT NULL, PRIMARY KEY (Id), UNIQUE (PostalCode), CONSTRAINT fk_address_state FOREIGN KEY (StateId) REFERENCES State (Id));
CREATE TABLE UserAddress (UserId INT(11), AddressId INT(11), PRIMARY KEY (UserId, AddressId), CONSTRAINT fk_user_address_user FOREIGN KEY (UserId) REFERENCES User(Id), CONSTRAINT fk_user_address_address FOREIGN KEY (AddressId) REFERENCES Address(Id));